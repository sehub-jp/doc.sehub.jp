---
---

# EC2 の開始方法

## インスタンスを起動
### 1. 「インスタンスを起動」ボタン押下

![インスタンスを起動](/public/aws/ec2/new-instans.png)

### 2. 設定値

1. 名前とタグ

    自由に設定すればいい。

1. アプリケーションおよび OS イメージ (Amazon マシンイメージ)

    自分に合うイメージを選択しましょう。

    Amazon Linux 2 を使い慣れたけど、PHP など古いバージョンしか入ってないので、
    
    今回は次世代の Amazon Linux 2022 にします。

    ::: tip
    `al2022` で検索すればでき来る
    ※今回はARMバージョンを使う
    :::

1. インスタンスタイプ

    今回は比較的に安い `t4g` を使います。

1. キーペア (ログイン)

    SSM（AWS Systems Manager）を使ってキーなしでもいいですが、Amazon Linux 2022 はデフォルトで `aws-ssm-agent` サービスが起動してないのでキー必須になります。
    既存キーがない場合は、「新しいキーペアの作成」で新しいキーペアを作成します。

    #### キーペア作成
    1. 「新しいキーペアの作成」押下

        ![新しいキーペアの作成](/public/aws/ec2/new-key.png)

    1. 詳細設定
        1. キーペア名

            自由に設定すればいい。
        
        2. キーペアのタイプ

            どちらでもいい、新しい `ED25519` にします。
        
        3. プライベートキーファイル形式

            `PuTTY` 使わないので、`.pem` にします。

            `PuTTY` を使う場合は `.ppk` にしましょう。

        ![キーペア作成詳細設定](/public/aws/ec2/new-key-detail.png)

        こんな感じ、「キーペアを作成」押下で新しいキーペアをダウンロードします。

1. ネットワーク設定
    ::: tip
    「編集」押下で編集可能な状態になる
    :::

    * VPC

        [VPC の開始方法](/aws/vpc/new-vpc) で作成したVPCを選択
    
    * サブネット

        外部からアクセスする必要なので、`public` のサブネットを選択しましょう。
    
    * パブリック IP の自動割り当て

        `有効化` にしましょう。
    
    * IPv6 IP を自動で割り当てる

        `有効化` にしましょう。
    
    * ファイアウォール (セキュリティグループ)

        `セキュリティグループを作成する` と `既存のセキュリティグループを選択する` どちらでもいい。
    
    * インバウンドセキュリティグループのルール
    
        デフォルトで `ssh` できるように `22` ポート許容になっているので、最低限これでいいでしょう。（ほかは起動後追加可能）
    
    その他の設定はとりあえずデフォルトでインスタンスを起動します。

    起動後、下記のように表示されます。
    
    ![インスタンス起動後](/public/aws/ec2/ec2-instans.png)